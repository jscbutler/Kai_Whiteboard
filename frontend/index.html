<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <title>Kai Family Whiteboard</title>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Kiosk mode styles */
        body {
            overflow: hidden;
            touch-action: none;
            user-select: none;
        }
        
        /* Kai Sleep Mode Animations */
        @keyframes breathe {
            0%, 100% { transform: scale(1) translateY(0); }
            50% { transform: scale(1.02) translateY(-5px); }
        }
        
        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-15px); }
        }
        
        @keyframes wiggle {
            0%, 100% { transform: rotate(-5deg); }
            50% { transform: rotate(5deg); }
        }
        
        @keyframes glow {
            0%, 100% { filter: drop-shadow(0 0 20px rgba(59, 130, 246, 0.5)); }
            50% { filter: drop-shadow(0 0 40px rgba(59, 130, 246, 0.8)); }
        }
        
        @keyframes blink {
            0%, 90%, 100% { transform: scaleY(1); }
            95% { transform: scaleY(0.1); }
        }
        
        .kai-sleep-avatar {
            animation: breathe 4s ease-in-out infinite, glow 3s ease-in-out infinite;
        }
        
        .kai-antennae {
            animation: wiggle 3s ease-in-out infinite;
            transform-origin: bottom center;
        }
        
        .kai-eyes {
            animation: blink 4s ease-in-out infinite;
        }
        
        /* Sleep mode ambient effects */
        .ambient-bubble {
            position: absolute;
            border-radius: 50%;
            background: radial-gradient(circle at 30% 30%, rgba(255,255,255,0.2), transparent);
            animation: float 6s ease-in-out infinite;
            pointer-events: none;
        }
        
        /* Regular Kai panel animations */
        .kai-avatar {
            animation: float 3s ease-in-out infinite;
        }
        
        /* Sleep screen fade */
        .fade-enter-active, .fade-leave-active {
            transition: opacity 0.5s ease;
        }
        .fade-enter-from, .fade-leave-to {
            opacity: 0;
        }
        
        /* Scrollbar for task list */
        .custom-scrollbar::-webkit-scrollbar {
            width: 6px;
        }
        .custom-scrollbar::-webkit-scrollbar-track {
            background: rgba(255,255,255,0.1);
        }
        .custom-scrollbar::-webkit-scrollbar-thumb {
            background: rgba(255,255,255,0.3);
            border-radius: 3px;
        }
        
        /* Theme transition */
        .theme-transition {
            transition: all 0.8s ease-in-out;
        }
        
        /* Swipe hint animation */
        @keyframes swipeHint {
            0%, 100% { transform: translateX(0); opacity: 0.3; }
            50% { transform: translateX(20px); opacity: 0.8; }
        }
        .swipe-hint {
            animation: swipeHint 2s ease-in-out infinite;
        }
        
        /* Floating decorative elements */
        @keyframes floatDecor {
            0%, 100% { transform: translateY(0) rotate(0deg); }
            25% { transform: translateY(-20px) rotate(5deg); }
            50% { transform: translateY(-10px) rotate(0deg); }
            75% { transform: translateY(-30px) rotate(-5deg); }
        }
        
        @keyframes drift {
            0% { transform: translateX(-100px) translateY(0); opacity: 0; }
            10% { opacity: 0.6; }
            90% { opacity: 0.6; }
            100% { transform: translateX(calc(100vw + 100px)) translateY(-50px); opacity: 0; }
        }
        
        @keyframes fall {
            0% { transform: translateY(-100px) rotate(0deg); opacity: 0; }
            10% { opacity: 0.8; }
            90% { opacity: 0.8; }
            100% { transform: translateY(calc(100vh + 100px)) rotate(360deg); opacity: 0; }
        }
        
        @keyframes twinkle {
            0%, 100% { opacity: 0.3; transform: scale(1); }
            50% { opacity: 1; transform: scale(1.2); }
        }
        
        @keyframes dance {
            0%, 100% { transform: rotate(-10deg) translateY(0); }
            25% { transform: rotate(10deg) translateY(-10px); }
            50% { transform: rotate(-5deg) translateY(0); }
            75% { transform: rotate(15deg) translateY(-5px); }
        }
        
        .floating-decor {
            position: absolute;
            font-size: 2rem;
            pointer-events: none;
            animation: floatDecor 4s ease-in-out infinite;
        }
        
        .drifting-decor {
            position: absolute;
            font-size: 2.5rem;
            pointer-events: none;
            animation: drift 15s linear infinite;
        }
        
        .falling-decor {
            position: absolute;
            font-size: 2rem;
            pointer-events: none;
            animation: fall 10s linear infinite;
        }
        
        .twinkling-decor {
            position: absolute;
            font-size: 1.5rem;
            pointer-events: none;
            animation: twinkle 2s ease-in-out infinite;
        }
        
        .dancing-decor {
            position: absolute;
            font-size: 3rem;
            pointer-events: none;
            animation: dance 2s ease-in-out infinite;
            transform-origin: bottom center;
        }
    </style>
</head>
<body class="bg-gray-900 text-white h-screen w-screen overflow-hidden">
    <div id="app" class="h-full w-full relative">
        
        <!-- SLEEP MODE - Kai Front and Center with Themes -->
        <transition name="fade">
            <div v-if="sleepMode" 
                 @click="wakeUp"
                 @touchstart="handleTouchStart"
                 @touchend="handleTouchEnd"
                 class="absolute inset-0 z-50 flex theme-transition"
                 :class="currentTheme.background">
                
                <!-- Ambient bubbles (theme colored) -->
                <div class="ambient-bubble w-32 h-32 top-10 left-10 opacity-30" :style="bubbleStyle(0)"></div>
                <div class="ambient-bubble w-24 h-24 top-40 right-20 opacity-20" :style="bubbleStyle(1)"></div>
                <div class="ambient-bubble w-40 h-40 bottom-20 left-1/4 opacity-25" :style="bubbleStyle(2)"></div>
                <div class="ambient-bubble w-20 h-20 top-1/3 left-1/3 opacity-15" :style="bubbleStyle(3)"></div>
                
                <!-- Theme decorations -->
                <div class="absolute top-4 left-4 text-6xl opacity-20">{{ currentTheme.emoji }}</div>
                <div class="absolute bottom-4 right-4 text-6xl opacity-20">{{ currentTheme.emoji }}</div>
                
                <!-- Floating themed decorations -->
                <div v-if="currentTheme.id === 'ireland'">
                    <div class="floating-decor" style="top: 15%; left: 8%; animation-delay: 0s;">â˜˜ï¸</div>
                    <div class="floating-decor" style="top: 60%; left: 5%; animation-delay: 1s;">ğŸ€</div>
                    <div class="floating-decor" style="top: 25%; right: 10%; animation-delay: 2s;">â˜˜ï¸</div>
                    <div class="drifting-decor" style="top: 40%; animation-delay: 0s;">ğŸª™</div>
                    <div class="drifting-decor" style="top: 70%; animation-delay: 5s;">ğŸŒˆ</div>
                </div>
                
                <div v-if="currentTheme.id === 'spain'">
                    <div class="dancing-decor" style="bottom: 30%; left: 10%;">ğŸ’ƒ</div>
                    <div class="dancing-decor" style="bottom: 20%; right: 15%; animation-delay: 0.5s;">ğŸ•º</div>
                    <div class="floating-decor" style="top: 20%; left: 15%; animation-delay: 0s;">ğŸŒ¹</div>
                    <div class="floating-decor" style="top: 50%; right: 8%; animation-delay: 1.5s;">ğŸª­</div>
                    <div class="drifting-decor" style="top: 35%; animation-delay: 2s;">ğŸ¸</div>
                </div>
                
                <div v-if="currentTheme.id === 'thailand'">
                    <div class="floating-decor" style="top: 10%; left: 12%; animation-delay: 0s;">ğŸ®</div>
                    <div class="floating-decor" style="top: 45%; left: 5%; animation-delay: 1.2s;">ğŸª·</div>
                    <div class="floating-decor" style="top: 30%; right: 12%; animation-delay: 2s;">ğŸ®</div>
                    <div class="floating-decor" style="bottom: 35%; right: 8%; animation-delay: 0.8s;">ğŸ™</div>
                    <div class="drifting-decor" style="top: 55%; animation-delay: 3s;">ğŸ˜</div>
                </div>
                
                <div v-if="currentTheme.id === 'halloween'">
                    <div class="floating-decor" style="top: 12%; left: 10%; animation-delay: 0s;">ğŸƒ</div>
                    <div class="floating-decor" style="top: 55%; left: 6%; animation-delay: 1s;">ğŸ‘»</div>
                    <div class="floating-decor" style="top: 20%; right: 10%; animation-delay: 2s;">ğŸ¦‡</div>
                    <div class="floating-decor" style="bottom: 40%; right: 12%; animation-delay: 0.5s;">ğŸ§™</div>
                    <div class="falling-decor" style="left: 20%; animation-delay: 0s;">ğŸ•·ï¸</div>
                    <div class="falling-decor" style="left: 60%; animation-delay: 3s;">ğŸ•¸ï¸</div>
                    <div class="falling-decor" style="left: 80%; animation-delay: 6s;">ğŸƒ</div>
                </div>
                
                <div v-if="currentTheme.id === 'christmas'">
                    <div class="falling-decor" style="left: 10%; animation-delay: 0s;">â„ï¸</div>
                    <div class="falling-decor" style="left: 30%; animation-delay: 2s;">ğŸŒ¨ï¸</div>
                    <div class="falling-decor" style="left: 50%; animation-delay: 4s;">â„ï¸</div>
                    <div class="falling-decor" style="left: 70%; animation-delay: 1s;">ğŸŒ¨ï¸</div>
                    <div class="falling-decor" style="left: 85%; animation-delay: 3s;">â„ï¸</div>
                    <div class="floating-decor" style="top: 15%; left: 15%; animation-delay: 0s;">ğŸ¦Œ</div>
                    <div class="floating-decor" style="top: 50%; right: 10%; animation-delay: 1s;">ğŸ§</div>
                    <div class="floating-decor" style="bottom: 30%; left: 8%; animation-delay: 2s;">ğŸ</div>
                    <div class="twinkling-decor" style="top: 25%; left: 25%;">â­</div>
                    <div class="twinkling-decor" style="top: 40%; right: 20%; animation-delay: 0.5s;">âœ¨</div>
                </div>
                
                <div v-if="currentTheme.id === 'ailand'">
                    <div class="floating-decor" style="top: 15%; left: 10%; animation-delay: 0s; opacity: 0.5; font-family: monospace; font-size: 1rem; color: #22d3ee;">0101</div>
                    <div class="floating-decor" style="top: 40%; left: 5%; animation-delay: 1s; opacity: 0.4; font-family: monospace; font-size: 0.9rem; color: #a855f7;">AI</div>
                    <div class="floating-decor" style="top: 25%; right: 12%; animation-delay: 2s; opacity: 0.5; font-family: monospace; font-size: 1.1rem; color: #22d3ee;">1010</div>
                    <div class="floating-decor" style="bottom: 35%; right: 8%; animation-delay: 0.8s; opacity: 0.4; font-family: monospace; font-size: 1rem; color: #a855f7;">KAI</div>
                    <div class="twinkling-decor" style="top: 20%; left: 20%;">âš¡</div>
                    <div class="twinkling-decor" style="top: 60%; right: 15%; animation-delay: 0.3s;">ğŸ’¾</div>
                    <div class="twinkling-decor" style="bottom: 25%; left: 30%; animation-delay: 0.7s;">ğŸŒ</div>
                </div>
                
                <!-- Swipe indicators -->
                <div v-if="activeThemes.length > 1" class="absolute inset-y-0 left-4 flex items-center">
                    <button @click.stop="prevTheme" class="text-4xl opacity-30 hover:opacity-80 transition p-4">â—€</button>
                </div>
                <div v-if="activeThemes.length > 1" class="absolute inset-y-0 right-4 flex items-center">
                    <button @click.stop="nextTheme" class="text-4xl opacity-30 hover:opacity-80 transition p-4">â–¶</button>
                </div>
                
                <!-- Main Kai Area -->
                <div class="flex-1 flex flex-col items-center justify-center relative">
                    <!-- Greeting -->
                    <div class="absolute top-8 text-center">
                        <h1 class="text-4xl font-light opacity-80 mb-2">{{ sleepGreeting }}</h1>
                        <p class="text-xl opacity-60">{{ currentTime }}</p>
                    </div>
                    
                    <!-- Theme Badge -->
                    <div class="absolute top-24 px-4 py-2 rounded-full bg-white bg-opacity-20 backdrop-blur">
                        <span class="text-lg">{{ currentTheme.emoji }} {{ currentTheme.name }}</span>
                    </div>
                    
                    <!-- Giant Themed Kai -->
                    <div class="kai-sleep-avatar relative cursor-pointer transform hover:scale-105 transition-transform">
                        <!-- Outer glow ring (theme colored) -->
                        <div class="absolute inset-0 rounded-full blur-3xl opacity-30 animate-pulse theme-transition"
                             :style="{ backgroundColor: currentTheme.glowColor }"></div>
                        
                        <!-- Kai SVG with theme colors -->
                        <svg width="350" height="350" viewBox="0 0 200 200" class="relative z-10">
                            <!-- Body -->
                            <ellipse cx="100" cy="120" rx="60" ry="50" :fill="currentTheme.bodyColor" />
                            <ellipse cx="100" cy="120" rx="50" ry="40" :fill="currentTheme.bodyLight" />
                            
                            <!-- Eyes -->
                            <g class="kai-eyes">
                                <ellipse cx="80" cy="100" rx="12" ry="15" fill="white" />
                                <ellipse cx="80" cy="100" rx="6" ry="8" fill="black" />
                                <ellipse cx="120" cy="100" rx="12" ry="15" fill="white" />
                                <ellipse cx="120" cy="100" rx="6" ry="8" fill="black" />
                            </g>
                            
                            <!-- Smile -->
                            <path d="M 85 135 Q 100 145 115 135" stroke="white" stroke-width="3" fill="none" stroke-linecap="round" />
                            
                            <!-- Antennae (theme colored) -->
                            <g class="kai-antennae">
                                <path d="M 70 75 Q 60 40 50 30" :stroke="currentTheme.bodyColor" stroke-width="4" fill="none" stroke-linecap="round" />
                                <circle cx="50" cy="30" r="6" :fill="currentTheme.accent" />
                                <path d="M 130 75 Q 140 40 150 30" :stroke="currentTheme.bodyColor" stroke-width="4" fill="none" stroke-linecap="round" />
                                <circle cx="150" cy="30" r="6" :fill="currentTheme.accent" />
                            </g>
                            
                            <!-- Claws -->
                            <ellipse cx="45" cy="130" rx="15" ry="20" :fill="currentTheme.bodyDark" />
                            <ellipse cx="155" cy="130" rx="15" ry="20" :fill="currentTheme.bodyDark" />
                            
                            <!-- Legs -->
                            <ellipse cx="65" cy="165" rx="8" ry="15" :fill="currentTheme.bodyColor" />
                            <ellipse cx="85" cy="168" rx="8" ry="15" :fill="currentTheme.bodyColor" />
                            <ellipse cx="115" cy="168" rx="8" ry="15" :fill="currentTheme.bodyColor" />
                            <ellipse cx="135" cy="165" rx="8" ry="15" :fill="currentTheme.bodyColor" />
                        </svg>
                        
                        <!-- Tap to wake hint -->
                        <div class="absolute -bottom-16 left-1/2 transform -translate-x-1/2 text-center">
                            <p class="text-lg opacity-60 animate-pulse">Tap anywhere to wake up</p>
                        </div>
                    </div>
                    
                    <!-- Themed Sleep message -->
                    <div class="absolute bottom-32 text-center max-w-md px-4">
                        <p class="text-2xl opacity-90 italic">"{{ currentTheme.message }}"</p>
                    </div>
                    
                    <!-- Theme dots indicator -->
                    <div v-if="activeThemes.length > 1" class="absolute bottom-12 flex gap-2">
                        <button v-for="(theme, idx) in activeThemes" :key="theme.id"
                                @click.stop="setTheme(idx)"
                                class="w-3 h-3 rounded-full transition-all"
                                :class="currentThemeIndex === idx ? 'bg-white scale-125' : 'bg-white opacity-30'">
                        </button>
                    </div>
                </div>
                
                <!-- Today's Tasks Sidebar -->
                <div class="w-96 bg-black bg-opacity-40 backdrop-blur-sm p-6 flex flex-col">
                    <h2 class="text-2xl font-bold mb-6 flex items-center gap-2">
                        ğŸ“‹ Today's Tasks
                    </h2>
                    
                    <div class="flex-1 overflow-y-auto custom-scrollbar space-y-4">
                        <!-- Next Up -->
                        <div v-if="nextEvent" class="rounded-lg p-4 border-l-4"
                             :class="currentTheme.upNextClass">
                            <p class="text-sm opacity-70 mb-1">Up Next</p>
                            <p class="text-lg font-semibold">{{ nextEvent.title }}</p>
                            <p class="text-sm opacity-80">{{ nextEvent.start }}</p>
                        </div>
                        
                        <!-- Today's Events -->
                        <div v-if="todayEvents.length === 0" class="text-center opacity-50 py-8">
                            <p class="text-4xl mb-2">{{ currentTheme.emoji }}</p>
                            <p>No events today!</p>
                            <p class="text-sm">Time to relax!</p>
                        </div>
                        
                        <div v-for="event in todayEvents" :key="event.id"
                             class="bg-white bg-opacity-10 rounded-lg p-3 flex items-center gap-3"
                             :class="{ 'opacity-50': event.isPast }">
                            <div class="w-2 h-12 rounded-full" :style="{ backgroundColor: event.color }"></div>
                            <div class="flex-1">
                                <p class="font-medium">{{ event.title }}</p>
                                <p class="text-sm opacity-70">{{ event.start }}</p>
                            </div>
                            <div v-if="event.isPast" class="text-xs bg-gray-600 px-2 py-1 rounded">Done</div>
                        </div>
                    </div>
                    
                    <!-- Quick stats -->
                    <div class="mt-6 pt-4 border-t border-white border-opacity-20">
                        <div class="flex justify-between text-sm opacity-70">
                            <span>Events today: {{ todayEvents.length }}</span>
                            <span>Completed: {{ completedEvents }}</span>
                        </div>
                    </div>
                </div>
            </div>
        </transition>
        
        <!-- MAIN APP - Calendar View -->
        <div v-if="!sleepMode" class="h-full w-full flex flex-col">
            <!-- Header -->
            <header class="flex justify-between items-center p-4 bg-opacity-20 bg-black">
                <div class="flex items-center gap-4">
                    <div class="text-2xl font-bold">
                        {{ currentDate }}
                    </div>
                    <div class="text-xl opacity-80">
                        {{ currentTime }}
                    </div>
                </div>
                <div class="flex items-center gap-2">
                    <span class="text-sm opacity-60">Weather:</span>
                    <span>â˜€ï¸ 12Â°C</span>
                    <button @click="enterSleepMode" class="ml-4 px-3 py-1 bg-white bg-opacity-10 rounded-lg hover:bg-opacity-20 transition text-sm">
                        ğŸ’¤ Sleep
                    </button>
                </div>
            </header>
            
            <!-- Main Content -->
            <main class="flex-1 flex overflow-hidden">
                <!-- Calendar View -->
                <div class="flex-1 p-4 overflow-y-auto">
                    <div class="grid grid-cols-7 gap-2 h-full">
                        <!-- Day headers -->
                        <div v-for="day in ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun']" 
                             :key="day"
                             class="text-center font-bold text-lg opacity-80">
                            {{ day }}
                        </div>
                        
                        <!-- Day cells -->
                        <div v-for="(day, index) in weekDays" 
                             :key="index"
                             class="border border-white border-opacity-20 rounded-lg p-2 min-h-[120px]"
                             :class="{ 'bg-white bg-opacity-10': day.isToday }">
                            <div class="text-sm opacity-60">{{ day.date }}</div>
                            <!-- Events -->
                            <div v-for="event in day.events" 
                                 :key="event.id"
                                 class="mt-1 p-1 rounded text-xs truncate"
                                 :style="{ backgroundColor: event.color }">
                                {{ event.title }}
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Kai Panel -->
                <div class="w-80 p-4 flex flex-col items-center justify-center border-l border-white border-opacity-20">
                    <!-- Kai Avatar -->
                    <div class="kai-avatar relative cursor-pointer" @click="interactWithKai">
                        <svg width="200" height="200" viewBox="0 0 200 200">
                            <ellipse cx="100" cy="120" rx="60" ry="50" fill="#3b82f6" />
                            <ellipse cx="100" cy="120" rx="50" ry="40" fill="#60a5fa" />
                            <ellipse cx="80" cy="100" rx="12" ry="15" fill="white" />
                            <ellipse cx="80" cy="100" rx="6" ry="8" fill="black" />
                            <ellipse cx="120" cy="100" rx="12" ry="15" fill="white" />
                            <ellipse cx="120" cy="100" rx="6" ry="8" fill="black" />
                            <path d="M 85 135 Q 100 145 115 135" stroke="white" stroke-width="3" fill="none" stroke-linecap="round" />
                            <path d="M 70 75 Q 60 40 50 30" stroke="#3b82f6" stroke-width="4" fill="none" stroke-linecap="round" />
                            <circle cx="50" cy="30" r="6" fill="#f59e0b" />
                            <path d="M 130 75 Q 140 40 150 30" stroke="#3b82f6" stroke-width="4" fill="none" stroke-linecap="round" />
                            <circle cx="150" cy="30" r="6" fill="#f59e0b" />
                        </svg>
                        <div class="absolute bottom-2 right-2 w-4 h-4 bg-green-500 rounded-full animate-pulse"></div>
                    </div>
                    
                    <!-- Kai Message -->
                    <div class="mt-4 p-4 bg-white bg-opacity-10 rounded-lg max-w-xs text-center">
                        <p class="text-lg">{{ kaiMessage }}</p>
                    </div>
                    
                    <!-- Voice indicator -->
                    <div v-if="isListening" class="mt-4 flex items-center gap-2">
                        <div class="w-3 h-3 bg-red-500 rounded-full animate-pulse"></div>
                        <span class="text-sm">Listening...</span>
                    </div>
                    
                    <!-- Quick actions -->
                    <div class="mt-8 flex flex-wrap gap-2 justify-center">
                        <button @click="addEvent" class="px-4 py-2 bg-blue-600 rounded-lg hover:bg-blue-700 transition">
                            + Event
                        </button>
                        <button @click="askKai" class="px-4 py-2 bg-green-600 rounded-lg hover:bg-green-700 transition">
                            Ask Kai
                        </button>
                        <button @click="getWordOfDay" class="px-4 py-2 bg-purple-600 rounded-lg hover:bg-purple-700 transition">
                            ğŸŒ Word
                        </button>
                        <button @click="interactWithKai" class="px-4 py-2 bg-orange-500 rounded-lg hover:bg-orange-600 transition">
                            ğŸ¦ Surprise!
                        </button>
                    </div>
                </div>
            </main>
        </div>
    </div>
    
    <script>
        const { createApp, ref, onMounted, computed } = Vue;
        
        createApp({
            setup() {
                const currentDate = ref('');
                const currentTime = ref('');
                const kaiMessage = ref('Hello! I am Kai. Tap me for a surprise!');
                const isListening = ref(false);
                const weekDays = ref([]);
                const sleepMode = ref(false);
                const API_URL = 'http://localhost:8000';
                let idleTimer = null;
                let themeRotationTimer = null;
                
                // Touch handling for swipe
                const touchStartX = ref(0);
                const touchEndX = ref(0);
                
                // Theme system
                const currentThemeIndex = ref(0);
                
                const allThemes = {
                    default: {
                        id: 'default',
                        name: 'Classic Kai',
                        emoji: 'ğŸ¦',
                        background: 'bg-gradient-to-br from-blue-900 via-purple-900 to-blue-900',
                        bodyColor: '#3b82f6',
                        bodyLight: '#60a5fa',
                        bodyDark: '#1e40af',
                        accent: '#f59e0b',
                        glowColor: '#3b82f6',
                        message: 'Dreaming of tomorrow adventures...',
                        upNextClass: 'bg-blue-600 bg-opacity-30 border-blue-400'
                    },
                    ireland: {
                        id: 'ireland',
                        name: 'Ireland',
                        emoji: 'â˜˜ï¸',
                        background: 'bg-gradient-to-br from-green-800 via-emerald-600 to-green-900',
                        bodyColor: '#059669',
                        bodyLight: '#34d399',
                        bodyDark: '#065f46',
                        accent: '#f97316',
                        glowColor: '#10b981',
                        message: 'Sure it is a lovely day for the craic!',
                        upNextClass: 'bg-green-600 bg-opacity-30 border-green-400'
                    },
                    spain: {
                        id: 'spain',
                        name: 'Spain',
                        emoji: 'ğŸ’ƒ',
                        background: 'bg-gradient-to-br from-red-700 via-yellow-600 to-red-800',
                        bodyColor: '#dc2626',
                        bodyLight: '#fbbf24',
                        bodyDark: '#991b1b',
                        accent: '#fbbf24',
                        glowColor: '#f59e0b',
                        message: 'Â¡OlÃ©! Viva la fiesta! Celeste would be proud!',
                        upNextClass: 'bg-red-600 bg-opacity-30 border-red-400'
                    },
                    thailand: {
                        id: 'thailand',
                        name: 'Thailand',
                        emoji: 'ğŸ™',
                        background: 'bg-gradient-to-br from-blue-600 via-purple-500 to-red-600',
                        bodyColor: '#2563eb',
                        bodyLight: '#a78bfa',
                        bodyDark: '#1e40af',
                        accent: '#fbbf24',
                        glowColor: '#fbbf24',
                        message: 'Sawasdee! Thinking of Thai temples and beaches...',
                        upNextClass: 'bg-purple-600 bg-opacity-30 border-purple-400'
                    },
                    halloween: {
                        id: 'halloween',
                        name: 'Halloween',
                        emoji: 'ğŸƒ',
                        background: 'bg-gradient-to-br from-orange-600 via-purple-900 to-black',
                        bodyColor: '#ea580c',
                        bodyLight: '#a855f7',
                        bodyDark: '#7c2d12',
                        accent: '#84cc16',
                        glowColor: '#a855f7',
                        message: 'Spooky scary skeletons... boo! ğŸ‘»',
                        upNextClass: 'bg-orange-600 bg-opacity-30 border-orange-400'
                    },
                    christmas: {
                        id: 'christmas',
                        name: 'Christmas',
                        emoji: 'ğŸ„',
                        background: 'bg-gradient-to-br from-red-800 via-green-700 to-red-900',
                        bodyColor: '#dc2626',
                        bodyLight: '#22c55e',
                        bodyDark: '#991b1b',
                        accent: '#fbbf24',
                        glowColor: '#fbbf24',
                        message: 'Ho ho ho! Merry Christmas from Kai! ğŸ…',
                        upNextClass: 'bg-red-600 bg-opacity-30 border-red-400'
                    },
                    ailand: {
                        id: 'ailand',
                        name: 'AI Land',
                        emoji: 'ğŸ¤–',
                        background: 'bg-gradient-to-br from-cyan-900 via-blue-800 to-purple-900',
                        bodyColor: '#0891b2',
                        bodyLight: '#22d3ee',
                        bodyDark: '#155e75',
                        accent: '#a855f7',
                        glowColor: '#22d3ee',
                        message: 'Beep boop! Calculating optimal dreams...',
                        upNextClass: 'bg-cyan-600 bg-opacity-30 border-cyan-400'
                    }
                };
                
                // For demo: show all themes
                const activeThemes = computed(() => [
                    allThemes.ireland,
                    allThemes.spain,
                    allThemes.thailand,
                    allThemes.halloween,
                    allThemes.christmas,
                    allThemes.ailand
                ]);
                
                const currentTheme = computed(() => {
                    return activeThemes.value[currentThemeIndex.value] || allThemes.default;
                });
                
                const sleepGreeting = computed(() => {
                    const hour = new Date().getHours();
                    if (hour < 12) return 'Good morning!';
                    if (hour < 18) return 'Good afternoon!';
                    return 'Good evening!';
                });
                
                const todayEvents = computed(() => {
                    const today = weekDays.value.find(d => d.isToday);
                    if (!today) return [];
                    const now = new Date();
                    return today.events.map(e => ({
                        ...e,
                        isPast: new Date(e.fullDate + 'T' + e.start) < now
                    })).sort((a, b) => a.start.localeCompare(b.start));
                });
                
                const nextEvent = computed(() => {
                    const now = new Date();
                    return todayEvents.value.find(e => !e.isPast);
                });
                
                const completedEvents = computed(() => {
                    return todayEvents.value.filter(e => e.isPast).length;
                });
                
                const bubbleStyle = (index) => {
                    const delays = ['0s', '1s', '2s', '3s'];
                    return {
                        animationDelay: delays[index % 4]
                    };
                };
                
                const updateTime = () => {
                    const now = new Date();
                    currentDate.value = now.toLocaleDateString('en-IE', { 
                        weekday: 'long', 
                        year: 'numeric', 
                        month: 'long', 
                        day: 'numeric' 
                    });
                    currentTime.value = now.toLocaleTimeString('en-IE', { 
                        hour: '2-digit', 
                        minute: '2-digit' 
                    });
                };
                
                const loadCalendar = async () => {
                    try {
                        const response = await fetch(API_URL + '/api/calendar/week');
                        const data = await response.json();
                        weekDays.value = data.days.map(day => ({
                            date: day.day_num,
                            fullDate: day.date,
                            dayName: day.day_name,
                            isToday: day.is_today,
                            events: day.events.map(e => ({
                                id: e.id,
                                title: e.title,
                                color: e.color,
                                start: new Date(e.start).toLocaleTimeString('en-IE', {hour: '2-digit', minute:'2-digit'})
                            }))
                        }));
                    } catch (e) {
                        console.error('Failed to load calendar:', e);
                    }
                };
                
                const interactWithKai = async () => {
                    kaiMessage.value = 'Thinking... ğŸ¤”';
                    resetIdleTimer();
                    try {
                        const response = await fetch(API_URL + '/api/kai/interact', {
                            method: 'POST',
                            headers: {'Content-Type': 'application/json'},
                            body: JSON.stringify({trigger: 'tap'})
                        });
                        const data = await response.json();
                        kaiMessage.value = data.message || 'Hello! I am Kai!';
                    } catch (e) {
                        const responses = [
                            'Did you know? Lobsters can live to be 100 years old! ğŸ¦',
                            'Â¡OlÃ©! Kelligh, you are fantastico! ğŸ’ƒ',
                            'Sawasdee! That is Hello in Thai! ğŸ‡¹ğŸ‡­',
                            'Mammy is the best! Give her a hug! ğŸ¤—',
                            'Kelligh, you are doing amazing today! â­',
                            'Today is going to be a great day! â˜€ï¸',
                            'Bart is such a good doggo! ğŸ•',
                            'I am learning new things every night! ğŸ“š'
                        ];
                        kaiMessage.value = responses[Math.floor(Math.random() * responses.length)];
                    }
                };
                
                const addEvent = () => {
                    kaiMessage.value = 'Say: Hey Kai, add event for...';
                    isListening.value = true;
                    resetIdleTimer();
                    setTimeout(() => { isListening.value = false; }, 3000);
                };
                
                const askKai = () => {
                    isListening.value = true;
                    kaiMessage.value = 'Listening... ğŸ‘‚';
                    resetIdleTimer();
                    setTimeout(() => {
                        isListening.value = false;
                        kaiMessage.value = 'I heard you! What would you like to know?';
                    }, 3000);
                };
                
                const getWordOfDay = async () => {
                    resetIdleTimer();
                    try {
                        const response = await fetch(API_URL + '/api/kai/interact', {
                            method: 'POST',
                            headers: {'Content-Type': 'application/json'},
                            body: JSON.stringify({trigger: 'word'})
                        });
                        const data = await response.json();
                        if (data.type === 'word_of_the_day') {
                            kaiMessage.value = data.language + ' Word: "' + data.word + '" means "' + data.english + '" (' + data.pronunciation + ')';
                        }
                    } catch (e) {
                        kaiMessage.value = 'Word of the day: Agua (Spanish) = Water ğŸ’§';
                    }
                };
                
                const nextTheme = () => {
                    currentThemeIndex.value = (currentThemeIndex.value + 1) % activeThemes.value.length;
                };
                
                const prevTheme = () => {
                    currentThemeIndex.value = (currentThemeIndex.value - 1 + activeThemes.value.length) % activeThemes.value.length;
                };
                
                const setTheme = (index) => {
                    currentThemeIndex.value = index;
                };
                
                const handleTouchStart = (e) => {
                    touchStartX.value = e.changedTouches[0].screenX;
                };
                
                const handleTouchEnd = (e) => {
                    touchEndX.value = e.changedTouches[0].screenX;
                    handleSwipe();
                };
                
                const handleSwipe = () => {
                    const swipeThreshold = 50;
                    const diff = touchStartX.value - touchEndX.value;
                    
                    if (Math.abs(diff) > swipeThreshold) {
                        if (diff > 0) {
                            nextTheme();
                        } else {
                            prevTheme();
                        }
                    }
                };
                
                const enterSleepMode = () => {
                    sleepMode.value = true;
                    currentThemeIndex.value = 0;
                    
                    // Auto-rotate themes every 10 seconds
                    if (themeRotationTimer) clearInterval(themeRotationTimer);
                    themeRotationTimer = setInterval(() => {
                        if (sleepMode.value && activeThemes.value.length > 1) {
                            nextTheme();
                        }
                    }, 10000);
                };
                
                const wakeUp = () => {
                    sleepMode.value = false;
                    if (themeRotationTimer) clearInterval(themeRotationTimer);
                    resetIdleTimer();
                    kaiMessage.value = 'Good to see you! â˜€ï¸';
                };
                
                const resetIdleTimer = () => {
                    if (idleTimer) clearTimeout(idleTimer);
                    idleTimer = setTimeout(() => {
                        if (!sleepMode.value) enterSleepMode();
                    }, 120000);
                };
                
                onMounted(() => {
                    updateTime();
                    setInterval(updateTime, 1000);
                    loadCalendar();
                    setInterval(loadCalendar, 300000);
                    resetIdleTimer();
                    
                    document.addEventListener('click', resetIdleTimer);
                    document.addEventListener('touchstart', resetIdleTimer);
                });
                
                return {
                    currentDate,
                    currentTime,
                    weekDays,
                    kaiMessage,
                    isListening,
                    sleepMode,
                    sleepGreeting,
                    todayEvents,
                    nextEvent,
                    completedEvents,
                    currentTheme,
                    currentThemeIndex,
                    activeThemes,
                    bubbleStyle,
                    interactWithKai,
                    addEvent,
                    askKai,
                    getWordOfDay,
                    enterSleepMode,
                    wakeUp,
                    nextTheme,
                    prevTheme,
                    setTheme,
                    handleTouchStart,
                    handleTouchEnd
                };
            }
        }).mount('#app');
    </script>
</body>
</html>